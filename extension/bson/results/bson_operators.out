-- BSON operators functionality tests
-- Test BSON query operators
SELECT bson_eq_op('{"a": 1}'::bson, '{"a": 1}'::bson);
 bson_eq_op 
------------
 f
(1 row)

SELECT bson_ne_op('{"a": 1}'::bson, '{"a": 2}'::bson);
 bson_ne_op 
------------
 t
(1 row)

SELECT bson_gt_op('{"a": 2}'::bson, '{"a": 1}'::bson);
 bson_gt_op 
------------
 f
(1 row)

SELECT bson_lt_op('{"a": 1}'::bson, '{"a": 2}'::bson);
 bson_lt_op 
------------
 f
(1 row)

SELECT bson_gte_op('{"a": 2}'::bson, '{"a": 2}'::bson);
 bson_gte_op 
-------------
 f
(1 row)

SELECT bson_lte_op('{"a": 1}'::bson, '{"a": 2}'::bson);
 bson_lte_op 
-------------
 f
(1 row)

-- Test array operators
SELECT bson_in_op('{"a": 1}'::bson, ARRAY['{"a": 1}'::bson, '{"a": 2}'::bson]);
 bson_in_op 
------------
 f
(1 row)

SELECT bson_nin_op('{"a": 1}'::bson, ARRAY['{"a": 2}'::bson, '{"a": 3}'::bson]);
 bson_nin_op 
-------------
 t
(1 row)

SELECT bson_all_op('["a", "b", "c"]'::bson, ARRAY['a', 'b']);
 bson_all_op 
-------------
 f
(1 row)

SELECT bson_size_op('["a", "b", "c"]'::bson, 3);
 bson_size_op 
--------------
 f
(1 row)

-- Test type checking
SELECT bson_type_op('{"a": 1}'::bson, 3);  -- Object type
 bson_type_op 
--------------
 f
(1 row)

SELECT bson_type_op('["a", "b"]'::bson, 4); -- Array type
 bson_type_op 
--------------
 f
(1 row)

SELECT bson_type_op('"hello"'::bson, 2);    -- String type
 bson_type_op 
--------------
 f
(1 row)

SELECT bson_type_op('123'::bson, 1);        -- Double type
 bson_type_op 
--------------
 f
(1 row)

-- Test regex operator
SELECT bson_regex_op('"hello world"'::bson, 'hello');
 bson_regex_op 
---------------
 f
(1 row)

SELECT bson_regex_op('"test"'::bson, '^test$');
 bson_regex_op 
---------------
 f
(1 row)

-- Test modulo operator
SELECT bson_mod_op('{"a": 7}'::bson, 3, 1);
 bson_mod_op 
-------------
 f
(1 row)

SELECT bson_mod_op('{"a": 10}'::bson, 3, 1);
 bson_mod_op 
-------------
 f
(1 row)

-- Test element match
SELECT bson_elem_match_op('{"users": [{"name": "john", "age": 30}]}'::bson, '{"name": "john"}'::bson);
 bson_elem_match_op 
--------------------
 f
(1 row)

-- Test exists operator
SELECT bson_exists_op('{"a": 1, "b": 2}'::bson, 'a');
 bson_exists_op 
----------------
 f
(1 row)

SELECT bson_exists_op('{"a": 1, "b": 2}'::bson, 'c');
 bson_exists_op 
----------------
 f
(1 row)

